{"version":3,"file":"static/js/952.cee60284.chunk.js","mappings":"uMAOA,MAqGA,EArG0BA,IACxB,MAAMC,GAAWC,EAAAA,EAAAA,OACX,KAAEC,IAASC,EAAAA,EAAAA,KAAaC,IAAK,IAAWA,MACxCC,GAAWC,EAAAA,EAAAA,OAEVC,EAAOC,IAAYC,EAAAA,EAAAA,UAAS,KAC5BC,EAAUC,IAAeF,EAAAA,EAAAA,UAAS,KAEzCG,EAAAA,EAAAA,YAAU,KACRJ,EAASK,OAAOC,aAAaC,QAAQ,yBACrCC,QAAQC,IAAIJ,OAAOK,SAASC,MAC5BH,QAAQC,IAAIJ,OAAOC,aAAaC,QAAQ,wBAAwB,GAC/D,IAEH,MAAMK,EAAeC,UAGnB,GAFAC,EAAEC,iBAEEb,EAASc,OAAS,EACpBC,EAAAA,GAAMC,MAAM,kDAId,GAAKnB,EAKL,IACE,MAAMoB,QAAeC,EAAAA,EAAKC,oBACxBtB,EACAM,OAAOK,SAASC,MAGlB,GADAH,QAAQC,IAAI,SAAUU,GAClBA,EAAOzB,KAAK4B,cAAe,CAE7BjB,OAAOC,aAAaiB,WAAW,wBAG/B,IAAI7B,EAAO0B,EAAAA,EAAKI,kBACV9B,EAAK+B,eAAevB,GAC1B,MAAMwB,QAAsBhC,EAAKiC,mBAGjCnB,QAAQC,IAAI,OAAQf,EAAM,gBAAiBgC,IAE3CE,EAAAA,EAAAA,IAAmBF,EAAcG,OAC9BC,MAAMC,IACLlC,EAAS,CACPmC,KAAM,iBACNC,QAAS,CACPC,KAAMH,EAASI,KAAKD,KACpBnC,MAAOgC,EAASI,KAAKpC,MACrB8B,MAAOH,EAAcG,MACrBO,KAAML,EAASI,KAAKC,KACpBC,GAAIN,EAASI,KAAKG,MAEpB,IAEHC,OAAOrB,GAAUV,QAAQC,IAAIS,KAEhC1B,EAAS,IACX,CACF,CAAE,MAAO0B,GACPV,QAAQC,IAAIS,GACZD,EAAAA,GAAMC,MAAMA,EACd,MA1CED,EAAAA,GAAMC,MAAM,qBA0Cd,EAuBF,OACEsB,EAAAA,EAAAA,KAAAC,EAAAA,SAAA,CAAAC,UACEF,EAAAA,EAAAA,KAAA,OAAKG,UAAU,gBAAeD,UAC5BE,EAAAA,EAAAA,MAAA,OAAKD,UAAU,MAAKD,SAAA,EAClBF,EAAAA,EAAAA,KAAA,OAAKG,UAAU,0BACfH,EAAAA,EAAAA,KAAA,MAAAE,SAAI,uBAvBRE,EAAAA,EAAAA,MAAA,QAAMC,SAAUjC,EAAa8B,SAAA,EAC3BF,EAAAA,EAAAA,KAAA,SAAOR,KAAK,QAAQW,UAAU,eAAeG,MAAO/C,EAAOgD,UAAQ,KAEnEP,EAAAA,EAAAA,KAAA,SACER,KAAK,WACLW,UAAU,eACVG,MAAO5C,EACP8C,SAAWlC,GAAMX,EAAYW,EAAEmC,OAAOH,OACtCI,WAAS,EACTC,YAAY,yBAEdX,EAAAA,EAAAA,KAAA,UACAA,EAAAA,EAAAA,KAAA,UAAQR,KAAK,SAASW,UAAU,qCAAoCD,SAAC,oCAetE,C","sources":["pages/auth/RegisterComplete.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { toast } from \"react-toastify\";\r\nimport { auth } from \"../../Firebase\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { createOrUpdateUser } from \"../../functions/authFunction\";\r\n\r\nconst RegisterComplete = (props) => {\r\n  const navigate = useNavigate();\r\n  const { user } = useSelector((state) => ({ ...state }));\r\n  const dispatch = useDispatch();\r\n\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setEmail(window.localStorage.getItem(\"emailForRegistration\"));\r\n    console.log(window.location.href);\r\n    console.log(window.localStorage.getItem(\"emailForRegistration\"));\r\n  }, []);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (password.length < 6) {\r\n      toast.error(\"password must be atleast 6 character Long\");\r\n      return;\r\n    }\r\n\r\n    if (!email) {\r\n      toast.error(\"Email  is Required\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = await auth.signInWithEmailLink(\r\n        email,\r\n        window.location.href\r\n      );\r\n      console.log(\"Result\", result);\r\n      if (result.user.emailVerified) {\r\n        ///remove the emaiil from the local storage\r\n        window.localStorage.removeItem(\"emailForRegistration\");\r\n\r\n        ///get user ID token(JWT)\r\n        let user = auth.currentUser;\r\n        await user.updatePassword(password);\r\n        const idTokenResult = await user.getIdTokenResult();\r\n\r\n        ///redux Store\r\n        console.log(\"user\", user, \"idTokenResult\", idTokenResult);\r\n\r\n        createOrUpdateUser(idTokenResult.token)\r\n          .then((response) => {\r\n            dispatch({\r\n              type: \"LOGGED_IN_USER\",\r\n              payload: {\r\n                name: response.data.name,\r\n                email: response.data.email,\r\n                token: idTokenResult.token,\r\n                role: response.data.role,\r\n                id: response.data._id,\r\n              },\r\n            });\r\n          })\r\n          .catch((error) => console.log(error));\r\n        ///redirectf\r\n        navigate(\"/\");\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      toast.error(error);\r\n    }\r\n  };\r\n\r\n  const registerCompleteForm = () => {\r\n    return (\r\n      <form onSubmit={handleSubmit}>\r\n        <input type=\"email\" className=\"form-control\" value={email} disabled />\r\n\r\n        <input\r\n          type=\"password\"\r\n          className=\"form-control\"\r\n          value={password}\r\n          onChange={(e) => setPassword(e.target.value)}\r\n          autoFocus\r\n          placeholder=\"Enter Your password\"\r\n        />\r\n        <br />\r\n        <button type=\"submit\" className=\"btn btn-secondary btn-lg btn-block\">\r\n          Complete Registeration\r\n        </button>\r\n      </form>\r\n    );\r\n  };\r\n  return (\r\n    <>\r\n      <div className=\"container p-5\">\r\n        <div className=\"row\">\r\n          <div className=\"col-md-6 offset-md-3\"></div>\r\n          <h4>Register Complete</h4>\r\n          {registerCompleteForm()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RegisterComplete;\r\n"],"names":["props","navigate","useNavigate","user","useSelector","state","dispatch","useDispatch","email","setEmail","useState","password","setPassword","useEffect","window","localStorage","getItem","console","log","location","href","handleSubmit","async","e","preventDefault","length","toast","error","result","auth","signInWithEmailLink","emailVerified","removeItem","currentUser","updatePassword","idTokenResult","getIdTokenResult","createOrUpdateUser","token","then","response","type","payload","name","data","role","id","_id","catch","_jsx","_Fragment","children","className","_jsxs","onSubmit","value","disabled","onChange","target","autoFocus","placeholder"],"sourceRoot":""}